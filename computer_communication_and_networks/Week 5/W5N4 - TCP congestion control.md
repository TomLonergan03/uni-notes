Having seen the [[W5N3 - Principles of congestion control|principles of congestion control]], we will now look at how [[W5N2 - TCP|TCP]] specifically manages congestion. TCP does this by limiting the rate at which the sender sends traffic into its connection to a function of the perceived network congestion. Alongside the receive window, `rwnd`, the TCP sender also maintains a congestion window variable, `cwnd`. The amount of data in flight at any moment must then be no more than `min(rwnd, cwnd)`. If we assume that `rwnd` is sufficiently large that it can be ignored, and that loss and transmission delays are negligible, the sender will send `cwnd` bytes of data, then wait until the end of the RTT when all those bytes are ACKed, and repeat, leading to a transmission rate of `cwnd`/RTT bps. By varying `cwnd`, TCP can control the rate of data transmission.

TCP perceives congestion occurring when there is a **loss event**: either a timeout occurs or 3 duplicate ACKs are received. If a loss event occurs, TCP reduces `cwnd`, but otherwise when an ACK is received `cwnd` is increased. As TCP uses acknowledgements to clock its window increases, it is said to be **self-clocking**.
# TCP congestion control algorithm
The TCP congestion control algorithm consists of 3 parts:
1. **Slow start**: initially, TCP ramps up `cwnd`, starting from 1 [[W5N2 - TCP#TCP data transfer|MSS]], and increases it by 1 MSS every time an ACK is received. If a loss event occurs, `cwnd` is set back to 1 MSS and the process repeats, except TCP also maintains a variable `ssthresh` (slow-start threshold), which is set to half the `cwnd` value at the time the loss event occurred. Once `cwnd` reaches `ssthresh`, slow start ends and enters congestion avoidance mode.
2. **Congestion avoidance**: now, `cwnd` is around half the value at which congestion last occurred, so TCP must be more careful. Therefore, `cwnd` is increased by 1 MSS every RTT, usually by increasing the window by $MSS/\text{number of bytes in flight}$ for each ACK. If a timeout occurs, the response is the same as in slow start, `ssthresh` is set to half of `cwnd`, `cwnd` is set to 1 MSS, and slow start mode is reentered. If 3 duplicate ACKs are received, then `ssthresh` is set to `cwnd`, and `cwnd` is halved (+ 3 MSS for the duplicate ACKs received), and it enters fast recovery mode.
3. **Fast recovery**: