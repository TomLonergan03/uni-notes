Context-free languages are used across natural language processing, for processing real words, as well as in compilers and programming language design.

# Syntax trees
A **syntax tree** shows the grammatical structure of a language.
Examples:
![[w13n4SyntaxTrees.png]]
A syntax tree has 2 kinds of symbols:
- Terminals (leaves) which are the basic words/expressions that a sentence in the language are built from
- Non-terminals (internal nodes) which don't appear in a sentence in the language, however instead they describe 'sub-phrases'
	- E.g. in the above image `Expr` represents some expression, which in this case then gets expanded into `- Var` and `Var` is then expanded into a variable name (`x1`)


# Defining a grammar
A grammar contains a start symbol, and a number of operations that can be applied to symbols. We often will also have a symbol for an empty terminal, often $\epsilon$, which terminates that branch of the tree without placing a word into the sentence.

For example, we can define a grammar for basic arithmetic expressions.
In this grammar there are the terminals: `+,-,(,),x,y,z,0,...,9`
and the non-terminals: `Exp, Var, Num`.
The start signal is `Exp`, and there are the following rules:
`Exp -> Exp + Exp`
`Exp -> Exp * Exp`
`Exp -> Var | Num | ( Exp )`
`Var -> x | y | z`
`Num -> 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9`

We can then generate this tree:
![[w13n4GeneratingSyntaxTree.png]]
First, `Exp` gets expanded into `Exp * Exp`.
Then on the right branch, `Exp` is expanded into `Num`, which is then expanded into `5`.
The central branch is already a terminal, so we then expand the left `Exp` into `( Exp )`, then that `Exp` is expanded into `Exp + Exp`. Next, those `Exp`s are expanded into `Var` and `Num` respectively, then those expand into `x` and `3`, finishing the tree.
This generates the sentence `5 * ( x + 3 )` and thus it is a legal expression in  the language.
There is no way for this grammar to generate `) 5 * + x`, which therefore isn't a valid expression in the language.

We can generate an infinite number of strings from this simple grammar.
The **language** defined by this grammar is the set of all strings of terminals than can be generated by a tree that follows the rules of the grammar.

# Structural ambiguity
In the above language, we can sometimes generate the same string with more than 1 tree. 
E.g. `1 + 2 + 3` can be generated by both these trees:
![[w13n4StructuralAmbiguity.png]]

This has no impact on the meaning of the sentence, however in the case of `1 + 2 * 3` we will get differing answers depending on which whether it is parsed as `(1 + 2) * 3` or `1 + (2 * 3)`.
- In some languages (generally artificial ones) we can define a strict precedence of operations (like with mathematics where `*` takes precedence over `+`)
- In natural languages, ambiguity is just a fact of life. There are many sentences in English which can have multiple meanings that must be inferred from context (e.g. I saw a man with a telescope)

# Formal definition
A context-free grammar $G$ consists of
- a finite set $\Sigma$ of terminals
- a finite set $N$ of non-terminals, disjoint from $\Sigma$
- a start symbol $S\in N$
- a finite set $P$ of productions of the form $X\rightarrow\alpha$ where $X\in N,\alpha\in(\Sigma\cup N)^*$

A **setential form** is any sequence of terminals and non-terminals which can be derived from the start symbol.

Formally, the set of setential forms derivable from $G$ is the smallest set $S(G)\subseteq(\Sigma\cup N)^*$ such that
- $S\in S(G)$
- if $\alpha X\beta\in S(G)$ and $X\rightarrow\gamma\in P$, then $\alpha\gamma\beta\in S(G)$

The **language** associated with a grammar is the set of setential forms that contain only terminals.
Formally, The language $L$ associated with $G$ is defined by $L(G)=S(G)\cap\Sigma^*$

A language $L\subseteq\Sigma^*$ is context-free if there exists some $G$ such that $L=L(G)$.

These grammars are **context-free** because a rule $X\rightarrow\alpha$ means that $X$ can always be expanded to $\alpha$ no matter where $X$ occurs.
This is in contrast with **context-sensitive** rules where $X$ might only be expandable in certain contexts.